{"ast":null,"code":"var _jsxFileName = \"/Users/rut/Documents/WCS Bootcamp/Projects/La Pegatina/LaPegatina/src/Components/Spotify/SpotifyRoundOne/SpotifyRoundOne.js\";\nimport React from 'react';\nimport '../../../App.css';\nimport '../Spotify.css';\nimport Sound from 'react-sound';\nimport Confetti from 'react-confetti';\nimport Button from '../Button/Button';\nimport Shuffle from '../../Utils/Shuffle';\nimport Spotify from '../../Utils/Spotify';\nimport PlayerCountdown from '../PlayerCountdown/PlayerCountdown';\nimport ShareTheGame from '../../ShareTheGame/ShareTheGame';\nimport texts from '../../../texts.json';\nimport ListenedSongs from '../ListenedSongs/ListenedSongs'; // import {Link} from 'react-router-dom';\n// import Register from '../../Register/Register'\n\nclass SpotifyRoundOne extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.spotifyObject = {};\n    this.spotifyFilteredObjArr = [];\n    this.chosenSong = '';\n    this.coincidence = false;\n    this.answerCountShow = false;\n    this.unknownSongs = [];\n    this.state = {\n      songNames: [],\n      currentSong: {\n        preview_url: '',\n        name: '',\n        uri: ''\n      },\n      hideResults: true,\n      correctAnswers: 0,\n      total: 0,\n      score: 0,\n      songUrl: '',\n      playerState: Sound.status.PLAYING,\n      playing: false,\n      playlistID: '37i9dQZF1DZ06evO2EUrsw'\n    };\n\n    this.getSongsToDisplay = currentSongName => {\n      const allSongsArr = this.spotifyObject.tracks.items.map(item => item.track.name);\n      const filteredSongsArr = allSongsArr.filter(song => song !== currentSongName);\n      const shuffledFilterSongsArr = Shuffle(filteredSongsArr);\n      const fourNonShuffledSongsArr = shuffledFilterSongsArr.slice(0, 3); // actually 3\n\n      fourNonShuffledSongsArr.push(currentSongName); // now 4\n\n      const fourShuffledSongsArr = Shuffle(fourNonShuffledSongsArr);\n      return fourShuffledSongsArr;\n    };\n\n    this.chooseSongs = () => {\n      const {\n        currentSong\n      } = this.state;\n      this.setState({\n        songNames: this.getSongsToDisplay(currentSong.name)\n      });\n    };\n\n    this.setNewRandomSong = () => {\n      const {\n        total\n      } = this.state;\n\n      if (this.spotifyFilteredObjArr.length === 0) {\n        return;\n      }\n\n      const randomSong = this.spotifyFilteredObjArr[Math.floor(Math.random() * this.spotifyFilteredObjArr.length)].track;\n      this.spotifyFilteredObjArr = this.spotifyFilteredObjArr.filter(song => song.track.id !== randomSong.id);\n      this.setState({\n        currentSong: {\n          preview_url: randomSong.preview_url,\n          name: randomSong.name,\n          uri: randomSong.uri\n        },\n        songNames: this.getSongsToDisplay(randomSong.name),\n        hideResults: true,\n        total: total + 1,\n        playerState: Sound.status.STOPPED\n      });\n    };\n\n    this.writeChosenSong = songName => {\n      this.chosenSong = songName;\n    };\n\n    this.throwConfetti = () => React.createElement(Confetti, {\n      width: 100,\n      height: 100,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    });\n\n    this.checkCoincidence = () => {\n      const {\n        currentSong,\n        correctAnswers,\n        score\n      } = this.state;\n      this.coincidence = currentSong.name === this.chosenSong;\n      this.unknownSongs.push(currentSong);\n      this.setState({\n        hideResults: false,\n        correctAnswers: this.coincidence ? correctAnswers + 1 : correctAnswers,\n        score: this.coincidence ? score + 10 : score\n      });\n\n      if (this.coincidence) {\n        this.throwConfetti();\n      }\n    };\n\n    this.showAnswerCount = () => {\n      this.answerCountShow = true;\n    };\n\n    this.getSongUrl = songName => {\n      // allTracksArr is an array made of tracks (each one, in an object,\n      // and as much tracks as songs are in the playlist)\n      const allTracksArr = this.spotifyFilteredObjArr.map(item => item.track); // trackArr is an array with an only index which is an object with 2 properties: name and preview_url\n\n      const oneTrackArr = allTracksArr.filter(track => track.name === songName); // Returns an array with the (only) object that fulfills this condition\n\n      const songUrl = oneTrackArr[0].preview_url;\n      this.setState({\n        songUrl,\n        playerState: Sound.status.PLAYING,\n        playing: true // return this.spotifyObject.tracks.items.filter(item => item.track.name === songName)[0].preview_url\n        // This does the same as getSongUrl but with much less lines\n\n      });\n    };\n\n    this.stopMusic = () => {\n      this.setState({\n        playerState: Sound.status.STOPPED,\n        playing: false\n      });\n    };\n\n    this.filterRightSongsFromSpotifyObject = () => {\n      this.spotifyFilteredObjArr = this.spotifyObject.tracks.items.filter(item => item.track.preview_url !== null);\n    };\n\n    this.setPlayingToFalse = () => {\n      this.setState({\n        playing: false\n      });\n    };\n  }\n\n  // API call to get the playlist data.\n  async componentDidMount() {\n    const {\n      playlistID\n    } = this.state;\n    this.spotifyObject = await Spotify.getPlaylist(playlistID);\n    this.filterRightSongsFromSpotifyObject();\n    this.setNewRandomSong();\n  }\n  /**\n   * This fn returns an array with 4 song names randomly including the current song\n   * @param {string} currentSong - name of the current song playing\n   * @returns {array} songsToDisplay\n  */\n\n\n  render() {\n    const {\n      score,\n      total,\n      currentSong,\n      hideResults,\n      songNames,\n      name,\n      songUrl,\n      correctAnswers,\n      playerState,\n      playing\n    } = this.state;\n    const {\n      language\n    } = this.props;\n    return React.createElement(\"section\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(ShareTheGame, {\n      score: score,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }), total < 10 ? React.createElement(\"div\", {\n      className: \"show\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"QuestionAndAnswers\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Countdown\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(PlayerCountdown, {\n      language: language,\n      onMusicPlays: this.chooseSongs,\n      setNewRandomSong: this.setNewRandomSong,\n      songURL: currentSong.preview_url,\n      coincidence: this.checkCoincidence,\n      showAnswerCount: this.showAnswerCount,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: `FourButtons ${hideResults ? 'forceGrayColor' : ''}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, songNames.map(songName => React.createElement(Button, {\n      key: songName,\n      printedSong: songName // We write it like this so the function writeChoosenSong isn't executed when the button is\n      // rendered but when the button is clicked. Different than what we're doing some lines\n      // above in the onMusicPlays, setNewRandomSong or songURL\n      ,\n      onClick: () => this.writeChosenSong(songName),\n      currentSong: currentSong.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      id: \"counter\",\n      className: \"instruct\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: this.answerCountShow ? 'show' : 'hide',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, texts[language].correctAnswers, correctAnswers, texts[language].outofText, total), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: this.answerCountShow ? 'show' : 'hide',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, texts[language].pointsText, score), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    })))) : React.createElement(ListenedSongs, {\n      username: name,\n      unknownSongs: this.unknownSongs,\n      language: language,\n      url: songUrl,\n      playStatus: playerState,\n      onClick: playing,\n      score: score,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default SpotifyRoundOne;","map":{"version":3,"sources":["/Users/rut/Documents/WCS Bootcamp/Projects/La Pegatina/LaPegatina/src/Components/Spotify/SpotifyRoundOne/SpotifyRoundOne.js"],"names":["React","Sound","Confetti","Button","Shuffle","Spotify","PlayerCountdown","ShareTheGame","texts","ListenedSongs","SpotifyRoundOne","Component","spotifyObject","spotifyFilteredObjArr","chosenSong","coincidence","answerCountShow","unknownSongs","state","songNames","currentSong","preview_url","name","uri","hideResults","correctAnswers","total","score","songUrl","playerState","status","PLAYING","playing","playlistID","getSongsToDisplay","currentSongName","allSongsArr","tracks","items","map","item","track","filteredSongsArr","filter","song","shuffledFilterSongsArr","fourNonShuffledSongsArr","slice","push","fourShuffledSongsArr","chooseSongs","setState","setNewRandomSong","length","randomSong","Math","floor","random","id","STOPPED","writeChosenSong","songName","throwConfetti","checkCoincidence","showAnswerCount","getSongUrl","allTracksArr","oneTrackArr","stopMusic","filterRightSongsFromSpotifyObject","setPlayingToFalse","componentDidMount","getPlaylist","render","language","props","outofText","pointsText"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../../App.css';\nimport '../Spotify.css';\nimport Sound from 'react-sound';\nimport Confetti from 'react-confetti';\nimport Button from '../Button/Button';\nimport Shuffle from '../../Utils/Shuffle';\nimport Spotify from '../../Utils/Spotify';\nimport PlayerCountdown from '../PlayerCountdown/PlayerCountdown';\nimport ShareTheGame from '../../ShareTheGame/ShareTheGame';\nimport texts from '../../../texts.json';\nimport ListenedSongs from '../ListenedSongs/ListenedSongs';\n// import {Link} from 'react-router-dom';\n// import Register from '../../Register/Register'\n\nclass SpotifyRoundOne extends React.Component {\n\n  // We have the object coming from the API call, here\n  spotifyObject = {};\n\n  // This array contains the songs coming from the spotifyObject that DO ave a preview_url\n  spotifyFilteredObjArr = [];\n\n  // Here the actual game mechanics start\n  chosenSong = '';\n\n  coincidence = false;\n\n  answerCountShow= false;\n\n  // All the songs that the user guessed wrong are pushed into this array\n  unknownSongs= [];\n\n  state = {\n\n      songNames: [],\n      currentSong: {\n          preview_url: '',\n          name: '',\n          uri: '',\n      },\n\n      hideResults: true,\n      correctAnswers: 0,\n      total: 0,\n      score: 0,\n      songUrl: '',\n      playerState: Sound.status.PLAYING,\n      playing: false,\n      playlistID: '37i9dQZF1DZ06evO2EUrsw',\n  }\n\n  // API call to get the playlist data.\n  async componentDidMount() {\n\n      const { playlistID } = this.state;\n\n      this.spotifyObject = await Spotify.getPlaylist(playlistID);\n      this.filterRightSongsFromSpotifyObject();\n      this.setNewRandomSong();\n  }\n\n  /**\n   * This fn returns an array with 4 song names randomly including the current song\n   * @param {string} currentSong - name of the current song playing\n   * @returns {array} songsToDisplay\n  */\ngetSongsToDisplay = (currentSongName) => {\n\n    const allSongsArr = this.spotifyObject.tracks.items.map((item) => item.track.name);\n\n    const filteredSongsArr = allSongsArr.filter((song) => (song !== currentSongName));\n\n    const shuffledFilterSongsArr = Shuffle(filteredSongsArr);\n\n    const fourNonShuffledSongsArr = shuffledFilterSongsArr.slice(0, 3); // actually 3\n    fourNonShuffledSongsArr.push(currentSongName); // now 4\n\n    const fourShuffledSongsArr = Shuffle(fourNonShuffledSongsArr);\n\n    return fourShuffledSongsArr;\n}\n\nchooseSongs = () => {\n\n    const { currentSong } = this.state;\n\n    this.setState({\n        songNames: this.getSongsToDisplay(currentSong.name),\n    });\n}\n\nsetNewRandomSong = () => {\n\n    const { total } = this.state;\n\n    if (this.spotifyFilteredObjArr.length === 0) {\n        return;\n    }\n\n    const randomSong = this.spotifyFilteredObjArr[Math.floor(Math.random() * this.spotifyFilteredObjArr.length)].track;\n\n    this.spotifyFilteredObjArr = this.spotifyFilteredObjArr.filter((song) => song.track.id !== randomSong.id);\n\n    this.setState({\n        currentSong: {\n            preview_url: randomSong.preview_url,\n            name: randomSong.name,\n            uri: randomSong.uri,\n        },\n        songNames: this.getSongsToDisplay(randomSong.name),\n        hideResults: true,\n        total: total + 1,\n        playerState: Sound.status.STOPPED,\n    });\n}\n\nwriteChosenSong = (songName) => {\n    this.chosenSong = songName;\n}\n\nthrowConfetti = () => (\n    <Confetti\n        width={100}\n        height={100}\n    />\n)\n\ncheckCoincidence = () => {\n\n    const { currentSong, correctAnswers, score } = this.state;\n\n    this.coincidence = currentSong.name === this.chosenSong;\n\n    this.unknownSongs.push(currentSong);\n\n    this.setState({\n        hideResults: false,\n        correctAnswers: this.coincidence ? (correctAnswers + 1) : correctAnswers,\n        score: this.coincidence ? (score + 10) : score,\n    });\n\n    if (this.coincidence) {\n        this.throwConfetti();\n    }\n}\n\nshowAnswerCount = () => {\n    this.answerCountShow = true;\n}\n\ngetSongUrl = (songName) => {\n\n    // allTracksArr is an array made of tracks (each one, in an object,\n    // and as much tracks as songs are in the playlist)\n    const allTracksArr = this.spotifyFilteredObjArr.map((item) => item.track);\n\n    // trackArr is an array with an only index which is an object with 2 properties: name and preview_url\n\n    const oneTrackArr = allTracksArr.filter((track) => (track.name === songName));\n    // Returns an array with the (only) object that fulfills this condition\n\n    const songUrl = oneTrackArr[0].preview_url;\n\n    this.setState({\n        songUrl,\n        playerState: Sound.status.PLAYING,\n        playing: true,\n        // return this.spotifyObject.tracks.items.filter(item => item.track.name === songName)[0].preview_url\n        // This does the same as getSongUrl but with much less lines\n    });\n}\n\nstopMusic = () => {\n    this.setState({\n        playerState: Sound.status.STOPPED,\n        playing: false,\n    });\n}\n\nfilterRightSongsFromSpotifyObject = () => {\n    this.spotifyFilteredObjArr = this.spotifyObject.tracks.items.filter((item) => item.track.preview_url !== null);\n}\n\nsetPlayingToFalse = () => {\n    this.setState({\n        playing: false,\n    });\n}\n\n\nrender() {\n\n    const { score, total, currentSong, hideResults, songNames, name, songUrl, correctAnswers, playerState, playing } = this.state;\n\n    const { language } = this.props;\n\n    return (\n        <section>\n            <ShareTheGame score={score} />\n            {total < 10\n                ? (\n                    <div className=\"show\">\n                        <div className=\"QuestionAndAnswers\">\n                            <div className=\"Countdown\">\n                                <PlayerCountdown\n                                    language={language}\n                                    onMusicPlays={this.chooseSongs}\n                                    setNewRandomSong={this.setNewRandomSong}\n                                    songURL={currentSong.preview_url}\n                                    coincidence={this.checkCoincidence}\n                                    showAnswerCount={this.showAnswerCount}\n                                />\n                            </div>\n                            <div className={`FourButtons ${hideResults ? 'forceGrayColor' : ''}`}>\n                                {songNames.map((songName) => (\n                                    <Button\n                                        key={songName}\n                                        printedSong={songName}\n                                        // We write it like this so the function writeChoosenSong isn't executed when the button is\n                                        // rendered but when the button is clicked. Different than what we're doing some lines\n                                        // above in the onMusicPlays, setNewRandomSong or songURL\n                                        onClick={() => this.writeChosenSong(songName)}\n                                        currentSong={currentSong.name}\n                                    />\n                                ))}\n                            </div>\n                            <div id=\"counter\" className=\"instruct\">\n                                <p className={this.answerCountShow ? 'show' : 'hide'}>\n                                    {texts[language].correctAnswers}\n                                    {correctAnswers}\n                                    {texts[language].outofText}\n                                    {total}\n                                </p>\n                                <br />\n                                <p className={this.answerCountShow ? 'show' : 'hide'}>\n                                    {texts[language].pointsText}\n                                    {score}\n                                </p>\n                                <hr />\n                            </div>\n                        </div>\n                    </div>\n                )\n                : (\n                    <ListenedSongs\n                        username={name}\n                        unknownSongs={this.unknownSongs}\n                        language={language}\n                        url={songUrl}\n                        playStatus={playerState}\n                        onClick={playing}\n                        score={score}\n                    />\n                )}\n            {/* {name !== undefined\n                ? <Link to='spotifyRoundTwo'>Go to Spotify round two</Link>\n                : <Register />\n            } */}\n        </section>\n    );\n}\n}\n\nexport default SpotifyRoundOne;\n"]},"metadata":{},"sourceType":"module"}